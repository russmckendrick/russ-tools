{
  "service": {
    "id": "azure-firewall",
    "name": "Azure Firewall",
    "description": "Query Azure Firewall network rule logs",
    "category": "Network Security"
  },
  "schema": {
    "tables": {
      "primary": "AZFWNetworkRule"
    },
    "fields": {
      "Action": {
        "type": "select",
        "description": "Firewall action",
        "kqlField": "Action",
        "options": ["Allow", "Deny", "DNAT"]
      },
      "SourceIp": {
        "type": "ipaddress",
        "description": "Source IP",
        "kqlField": "SourceIp",
        "supportsCIDR": true
      },
      "DestinationIp": {
        "type": "ipaddress",
        "description": "Destination IP",
        "kqlField": "DestinationIp",
        "supportsCIDR": true
      },
      "DestinationPort": {
        "type": "number",
        "description": "Destination port",
        "kqlField": "DestinationPort",
        "min": 1,
        "max": 65535
      },
      "Fqdn": {
        "type": "string",
        "description": "Fully qualified domain name",
        "kqlField": "Fqdn"
      }
    },
    "filterOrder": [
      "timeRange",
      "SubscriptionId",
      "ResourceGroup",
      "ResourceId",
      "Action",
      "Fqdn",
      "SourceIp",
      "DestinationIp",
      "DestinationPort"
    ]
  },
  "templates": {
    "basic": {
      "name": "Network Rule Query",
      "description": "Time range and optional action/IP/port filters",
      "table": "AZFWNetworkRule",
      "defaultParameters": {
        "timeRange": "24h",
        "limit": "1000"
      },
      "fields": [
        { "name": "Fqdn", "exclude": true }
      ]
    },
    "application": {
      "name": "Application Rule Query",
      "description": "Time range and optional FQDN filters for application rules",
      "table": "AZFWApplicationRule",
      "defaultParameters": {
        "timeRange": "24h",
        "limit": "1000"
      },
      "fields": [
        { "name": "Fqdn", "label": "FQDN", "essential": true },
        { "name": "DestinationIp", "exclude": true }
      ]
    }
  }
}


