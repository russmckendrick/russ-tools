{
  "service": {
    "id": "azure-application-gateway",
    "name": "Azure Application Gateway",
    "description": "Query Application Gateway access logs",
    "category": "Load Balancing"
  },
  "schema": {
    "tables": {
      "primary": "AzureDiagnostics"
    },
    "fields": {
      "Category": {
        "type": "select",
        "description": "Log category",
        "kqlField": "Category",
        "options": [
          "ApplicationGatewayAccessLog",
          "ApplicationGatewayPerformanceLog",
          "ApplicationGatewayFirewallLog"
        ]
      },
      "httpStatus_d": {
        "type": "number",
        "description": "HTTP status",
        "kqlField": "httpStatus_d",
        "min": 100,
        "max": 599
      },
      "clientIP_s": {
        "type": "ipaddress",
        "description": "Client IP",
        "kqlField": "clientIP_s",
        "supportsCIDR": true
      },
      "requestUri_s": {
        "type": "string",
        "description": "Request URI contains",
        "kqlField": "requestUri_s"
      }
    },
    "filterOrder": [
      "timeRange",
      "SubscriptionId",
      "ResourceGroup",
      "ResourceId",
      "Category",
      "httpStatus_d",
      "clientIP_s",
      "requestUri_s"
    ]
  },
  "templates": {
    "basic": {
      "name": "Basic Access Log Query",
      "description": "Time range with optional category/status/IP/URI filters",
      "table": "AzureDiagnostics",
      "defaultParameters": {
        "timeRange": "24h",
        "Category": "ApplicationGatewayAccessLog",
        "limit": "1000"
      }
    }
  }
}


