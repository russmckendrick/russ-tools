{
  "service": {
    "id": "azure-virtual-desktop",
    "name": "Azure Virtual Desktop",
    "description": "Query AVD connection logs",
    "category": "Virtual Desktop Infrastructure"
  },
  "schema": {
    "tables": {
      "primary": "WVDConnections"
    },
    "fields": {
      "UserName": {
        "type": "string",
        "description": "User principal name",
        "kqlField": "UserName"
      },
      "ClientIPAddress": {
        "type": "ipaddress",
        "description": "Client IP",
        "kqlField": "ClientIPAddress",
        "supportsCIDR": true
      },
      "State": {
        "type": "select",
        "description": "Connection state",
        "kqlField": "State",
        "options": ["Connected", "Completed", "Failed", "Started"]
      }
    },
    "filterOrder": [
      "timeRange",
      "SubscriptionId",
      "ResourceGroup",
      "ResourceId",
      "UserName",
      "State",
      "ClientIPAddress"
    ]
  },
  "templates": {
    "basic": {
      "name": "Basic AVD Query",
      "description": "Time range with optional user/state/IP filters",
      "table": "WVDConnections",
      "defaultParameters": {
        "timeRange": "24h",
        "limit": "1000"
      }
    }
  }
}


